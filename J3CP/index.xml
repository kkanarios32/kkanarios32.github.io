<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="/default.xsl"?>
<fr:tree xmlns:fr="http://www.forester-notes.org" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xml="http://www.w3.org/XML/1998/namespace" root="false" base-url="/">
  <fr:frontmatter>
    <fr:authors>
      <fr:author>
        <fr:link href="/kellenkanarios/" title="Kellen Kanarios" uri="https://kellenkanarios.com/kellenkanarios/" display-uri="kellenkanarios" type="local">Kellen Kanarios</fr:link>
      </fr:author>
    </fr:authors>
    <fr:date>
      <fr:year>2025</fr:year>
      <fr:month>8</fr:month>
      <fr:day>31</fr:day>
    </fr:date>
    <fr:uri>https://kellenkanarios.com/J3CP/</fr:uri>
    <fr:display-uri>J3CP</fr:display-uri>
    <fr:route>/J3CP/</fr:route>
    <fr:title text="Reinforcement Learning \iff  Linear Programming">Reinforcement Learning <fr:tex display="inline"><![CDATA[\iff ]]></fr:tex> Linear Programming</fr:title>
  </fr:frontmatter>
  <fr:mainmatter>
  <fr:tree show-metadata="false"><fr:frontmatter><fr:authors><fr:author><fr:link href="/kellenkanarios/" title="Kellen Kanarios" uri="https://kellenkanarios.com/kellenkanarios/" display-uri="kellenkanarios" type="local">Kellen Kanarios</fr:link></fr:author></fr:authors><fr:date><fr:year>2025</fr:year><fr:month>8</fr:month><fr:day>31</fr:day></fr:date><fr:title text="Linear Program">Linear Program</fr:title></fr:frontmatter><fr:mainmatter>
    For this note, we will consider a <html:em>maximization</html:em> linear program. Namely, an optimization problem of the following form
    <fr:tex display="block"><![CDATA[
        \begin {align*}
        \max _{\mathbf {x}} \quad  &\mathbf {c}^{\top } \mathbf {x} \\
        \text {s.t.} \quad  &A\mathbf {x} \leq  b
        .\end {align*}
        ]]></fr:tex>
        In the spirit of <html:em>lagrange multipliers</html:em>, we can also get a <html:em>dual formulation</html:em>. To do so, we add a multiplier <fr:tex display="inline"><![CDATA[y_i]]></fr:tex> for each constraint i.e. 
        <fr:tex display="block"><![CDATA[y_i \mathbf {a}_i^T \mathbf {x} \leq  y_i b_i]]></fr:tex>
        we then consider the summed constraint (which ends up being tight enough),
        <fr:tex display="block"><![CDATA[\mathbf {y}^T A \mathbf {x} \leq  \mathbf {y}^T\mathbf {b}]]></fr:tex>
        To relate this back to our primal problem, we enforce the additional constraint that <fr:tex display="block"><![CDATA[\mathbf {y}^T A = \mathbf {c}^T \iff  A \mathbf {y} = \mathbf {c} ]]></fr:tex>. The reason for this is that for a feasible <fr:tex display="inline"><![CDATA[\mathbf {y}]]></fr:tex>, we have
        <fr:tex display="block"><![CDATA[\mathbf {y}^T A \mathbf {x} = \mathbf {c}^T \mathbf {x} \leq  \mathbf {y}^T \mathbf {b},  ]]></fr:tex>
        so that <fr:tex display="inline"><![CDATA[\mathbf {y}^T \mathbf {b}]]></fr:tex> is an upper bound for our primal objective <fr:tex display="inline"><![CDATA[\mathbf {c}^T \mathbf {x} ]]></fr:tex>. Intuitively, to recover <fr:tex display="inline"><![CDATA[\mathbf {c}^T \mathbf {x}^* ]]></fr:tex>, we can just minimize over <fr:tex display="inline"><![CDATA[\mathbf {y}]]></fr:tex>, resulting in the following <html:em>dual</html:em> program
        <fr:tex display="block"><![CDATA[
            \begin {align*}
             \min _{\mathbf {y}} \quad  &\mathbf {b}^T\mathbf {y} \\   
             \text {s.t.} \quad  &A \mathbf {y} = \mathbf {c} \\ 
             & \mathbf {y} \geq  0
            .\end {align*}
            ]]></fr:tex>
</fr:mainmatter></fr:tree>

  <fr:tree show-metadata="false"><fr:frontmatter><fr:authors><fr:author><fr:link href="/kellenkanarios/" title="Kellen Kanarios" uri="https://kellenkanarios.com/kellenkanarios/" display-uri="kellenkanarios" type="local">Kellen Kanarios</fr:link></fr:author></fr:authors><fr:date><fr:year>2025</fr:year><fr:month>8</fr:month><fr:day>31</fr:day></fr:date><fr:title text="RL as Linear Program">RL as Linear Program</fr:title></fr:frontmatter><fr:mainmatter>
    Let <fr:tex display="inline"><![CDATA[\rho (s) \in  \mathbb {R}^{|\mathcal {S}|} ]]></fr:tex> be the initial state distribution. Then consider the following LP 
    <fr:tex display="block"><![CDATA[\begin {align*}
\begin {array}{ll} \displaystyle  \max _{V \in  \mathbb {R}^{|\mathcal {S}|}} & \displaystyle  \sum _{s \in  \mathcal {S}} \rho (s) V(s) \\ \text {s.t.} & V(s) \leq  r(s,a) + \gamma  \sum _{s'} P(s' \mid  s,a) \, V(s'), \qquad  \forall  s,a. \end {array}
    \end {align*}]]></fr:tex>
    Translating this into our standard form, we have
    <html:ol><html:li><fr:tex display="inline"><![CDATA[\mathbf {c} \in  \mathbb {R}^{|\mathcal {S}|}]]></fr:tex> with <fr:tex display="inline"><![CDATA[c_s = \rho (s)]]></fr:tex></html:li>
      <html:li><fr:tex display="inline"><![CDATA[A \in  \mathbb {R}^{|\mathcal {S}| \times  |\mathcal {A}| \times  |\mathcal {S}|}]]></fr:tex> with <fr:tex display="inline"><![CDATA[A_{(s,a),s'} = -\delta _{s,s'} + \gamma  P(s'|s,a).
]]></fr:tex></html:li></html:ol>
    Substituting this in for the dual formulation gives us
    <fr:tex display="block"><![CDATA[\begin {align*}
& \min _{y(s,a) \geq  0} & & \sum _{s,a} r(s,a) \, y(s,a) \\ & \text {s.t.} & & \sum _{a} y(s,a) - \gamma  \sum _{s',a'} P(s \mid  s',a') \, y(s',a') = \rho (s), \qquad  \forall  s
    \end {align*}]]></fr:tex>
    Here <fr:tex display="inline"><![CDATA[\mathbf {y}]]></fr:tex> can be seen as the <html:em>discounted occupancy measure</html:em>. This allows us to recover a randomized optimal policy via
    <fr:tex display="block"><![CDATA[\mathbb {P}(\pi ^*(s) = a) = \frac {y(s, a)}{\sum _{a} y(s,a)}]]></fr:tex>
</fr:mainmatter></fr:tree>
</fr:mainmatter>
  <fr:backmatter>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="References">References</fr:title>
      </fr:frontmatter>
      <fr:mainmatter />
    </fr:tree>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="Context">Context</fr:title>
      </fr:frontmatter>
      <fr:mainmatter />
    </fr:tree>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="Backlinks">Backlinks</fr:title>
      </fr:frontmatter>
      <fr:mainmatter />
    </fr:tree>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="Related">Related</fr:title>
      </fr:frontmatter>
      <fr:mainmatter />
    </fr:tree>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="Contributions">Contributions</fr:title>
      </fr:frontmatter>
      <fr:mainmatter />
    </fr:tree>
  </fr:backmatter>
</fr:tree>
