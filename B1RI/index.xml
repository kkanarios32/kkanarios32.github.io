<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="/default.xsl"?>
<fr:tree xmlns:fr="http://www.forester-notes.org" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xml="http://www.w3.org/XML/1998/namespace" root="false" base-url="/">
  <fr:frontmatter>
    <fr:authors />
    <fr:date>
      <fr:year>2025</fr:year>
      <fr:month>7</fr:month>
      <fr:day>14</fr:day>
    </fr:date>
    <fr:uri>https://kellenkanarios.com/B1RI/</fr:uri>
    <fr:display-uri>B1RI</fr:display-uri>
    <fr:route>/B1RI/</fr:route>
    <fr:title text="Inner Product">Inner Product</fr:title>
    <fr:taxon>Definition</fr:taxon>
  </fr:frontmatter>
  <fr:mainmatter>
    <html:p>Given a vector space <fr:tex display="inline"><![CDATA[V]]></fr:tex> and a <fr:link href="/X9AO/" title="Field" uri="https://kellenkanarios.com/X9AO/" display-uri="X9AO" type="local">field</fr:link> <fr:tex display="inline"><![CDATA[F]]></fr:tex>. An <html:em>inner product</html:em> is a map
<fr:tex display="block"><![CDATA[\langle  \cdot , \cdot  \rangle  : V \times  V \to  F]]></fr:tex>
that satisfies the following three properties:
<html:ul><html:li><html:em>Conjugate symmetry</html:em>: <fr:tex display="inline"><![CDATA[\langle  \mathbf {x}, \mathbf {y} \rangle  = \overline {\langle  \mathbf {y}, \mathbf {x}\rangle }]]></fr:tex></html:li>
  <html:li><html:em>Linearity</html:em> in the first argument: <fr:tex display="inline"><![CDATA[\langle  a\mathbf {x} + b\mathbf {y}, \mathbf {z} \rangle  = a\langle  \mathbf {x}, \mathbf {z} \rangle  + b \langle  \mathbf {y}, \mathbf {z} \rangle ]]></fr:tex></html:li>
  <html:li><html:em>Positive-definiteness</html:em>: If <fr:tex display="inline"><![CDATA[\mathbf {x}]]></fr:tex> is not zero, then <fr:tex display="inline"><![CDATA[\langle  \mathbf {x}, \mathbf {x} \rangle  > 0]]></fr:tex></html:li></html:ul></html:p>
  </fr:mainmatter>
  <fr:backmatter>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="References">References</fr:title>
      </fr:frontmatter>
      <fr:mainmatter />
    </fr:tree>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="Context">Context</fr:title>
      </fr:frontmatter>
      <fr:mainmatter />
    </fr:tree>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="Backlinks">Backlinks</fr:title>
      </fr:frontmatter>
      <fr:mainmatter>
        <fr:tree show-metadata="true" expanded="false" toc="false" numbered="false">
          <fr:frontmatter>
            <fr:authors />
            <fr:date>
              <fr:year>2025</fr:year>
              <fr:month>7</fr:month>
              <fr:day>14</fr:day>
            </fr:date>
            <fr:uri>https://kellenkanarios.com/TOD6/</fr:uri>
            <fr:display-uri>TOD6</fr:display-uri>
            <fr:route>/TOD6/</fr:route>
            <fr:title text="Rotary Position Embeddings (ROPE)">Rotary Position Embeddings (ROPE)</fr:title>
          </fr:frontmatter>
          <fr:mainmatter><html:p><html:strong>Notation</html:strong>:
For this section, our notion of an <html:em>embedding</html:em> is a function <fr:tex display="inline"><![CDATA[f]]></fr:tex> that takes a token and a position i.e. <fr:tex display="inline"><![CDATA[f(x, i)]]></fr:tex> is the embedding of token <fr:tex display="inline"><![CDATA[x]]></fr:tex>, occurring at position <fr:tex display="inline"><![CDATA[i]]></fr:tex>.
</html:p><html:p><html:strong>Idea:</html:strong> the <fr:link href="/B1RI/" title="Inner Product" uri="https://kellenkanarios.com/B1RI/" display-uri="B1RI" type="local">inner product</fr:link> of two embeddings should only need relative positioning i.e. for any two <fr:tex display="inline"><![CDATA[\mathbf {x}]]></fr:tex>, <fr:tex display="inline"><![CDATA[\mathbf {y}]]></fr:tex> with positions <fr:tex display="inline"><![CDATA[i]]></fr:tex> and <fr:tex display="inline"><![CDATA[j]]></fr:tex> respectively, there should exist some <fr:tex display="inline"><![CDATA[g]]></fr:tex>, such that
<fr:tex display="block"><![CDATA[\langle  f(\mathbf {x}, i), f(\mathbf {y}, j) \rangle  = g(\mathbf {x}, \mathbf {y}, i - j)]]></fr:tex>
Namely, this can be written as a function of just the relative positioning between the embeddings.
</html:p><html:p>The simplest transformation that only preserves this relative information are <fr:link href="/10H9/" title="Rotation matrix" uri="https://kellenkanarios.com/10H9/" display-uri="10H9" type="local">rotations</fr:link>.</html:p><html:figure><html:img width="50%" src="/bafkrmiba4muc7qqk2agccjalqpm24hxw7u4gkfpozmnhz7if6ncagxpsgi.png" />
<html:figcaption>Rotating embeddings does not change relative position.</html:figcaption></html:figure><html:p>However, <fr:link href="/10H9/" title="Rotation matrix" uri="https://kellenkanarios.com/10H9/" display-uri="10H9" type="local">rotations</fr:link> are only easily defined for <fr:tex display="inline"><![CDATA[\mathbb {R}^2]]></fr:tex>. To get around this, they simply partition their input 2d slices and apply the rotation via
<fr:tex display="block"><![CDATA[\mathrm {ROT} = \begin {bmatrix} \cos  m \theta _{1} & - \sin  m \theta _{1} & & & \\
\sin  m \theta _{1} & \cos  m \theta _{1} & & & \\
& & \cos  m \theta _{2} & -\sin  m \theta _{2} & \\
& & \sin  m \theta _{2} & \cos  m \theta _{2} & \\
& & & & \ddots 
\end {bmatrix} ]]></fr:tex></html:p>
    <fr:tree show-metadata="false" toc="false"><fr:frontmatter><fr:authors /><fr:date><fr:year>2025</fr:year><fr:month>7</fr:month><fr:day>14</fr:day></fr:date><fr:taxon>Remark</fr:taxon></fr:frontmatter><fr:mainmatter>
The <fr:tex display="inline"><![CDATA[\theta _i]]></fr:tex>'s are fixed and chosen according to some schedule to capture different "frequencies". 
</fr:mainmatter></fr:tree>
<html:p>The embedding are used by appling them to the query and key matrices separately i.e. 
<fr:tex display="block"><![CDATA[W_K = \mathrm {ROT}(W_K), \quad  W_Q = \mathrm {ROT}(W_Q)]]></fr:tex>
These are then what is used in self-attention.
</html:p></fr:mainmatter>
        </fr:tree>
      </fr:mainmatter>
    </fr:tree>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="Related">Related</fr:title>
      </fr:frontmatter>
      <fr:mainmatter>
        <fr:tree show-metadata="true" expanded="false" toc="false" numbered="false">
          <fr:frontmatter>
            <fr:authors />
            <fr:date>
              <fr:year>2025</fr:year>
              <fr:month>7</fr:month>
              <fr:day>14</fr:day>
            </fr:date>
            <fr:uri>https://kellenkanarios.com/X9AO/</fr:uri>
            <fr:display-uri>X9AO</fr:display-uri>
            <fr:route>/X9AO/</fr:route>
            <fr:title text="Field">Field</fr:title>
            <fr:taxon>Definition</fr:taxon>
          </fr:frontmatter>
          <fr:mainmatter>
            <html:p>A <html:em>field</html:em> is a set <fr:tex display="inline"><![CDATA[F]]></fr:tex> together with two binary operations on <fr:tex display="inline"><![CDATA[F]]></fr:tex>: <fr:tex display="inline"><![CDATA[+]]></fr:tex> and <fr:tex display="inline"><![CDATA[\cdot ]]></fr:tex>, where a <html:em>binary operation</html:em> is a mapping <fr:tex display="inline"><![CDATA[F \times  F \to  F]]></fr:tex>. These operations are defined by the following axioms
<html:ul><html:li><html:em>Associativity of addition and multiplication</html:em>: <fr:tex display="inline"><![CDATA[a + (b + c) = (a + b) + c]]></fr:tex>, and <fr:tex display="inline"><![CDATA[a \cdot  (b \cdot  c) = (a \cdot  b) \cdot  c]]></fr:tex>.</html:li>
  <html:li><html:em>Commutativity of addition and multiplication</html:em>: <fr:tex display="inline"><![CDATA[a + b = b + a]]></fr:tex>, and <fr:tex display="inline"><![CDATA[a \cdot  b = b \cdot  a]]></fr:tex>.</html:li>
  <html:li><html:em>Additive and multiplicative identity</html:em>: there exist two distinct elements 0 and 1 in <fr:tex display="inline"><![CDATA[F]]></fr:tex> such that <fr:tex display="inline"><![CDATA[a + 0 = a]]></fr:tex> and <fr:tex display="inline"><![CDATA[a \cdot  1 = a]]></fr:tex>.</html:li>
  <html:li><html:em>Additive inverses</html:em>: for every <fr:tex display="inline"><![CDATA[a]]></fr:tex> in <fr:tex display="inline"><![CDATA[F]]></fr:tex>, there exists an element in <fr:tex display="inline"><![CDATA[F]]></fr:tex>, denoted <fr:tex display="inline"><![CDATA[-a]]></fr:tex>, called the <html:em>additive inverse</html:em> of <html:em>a</html:em>, such that <fr:tex display="inline"><![CDATA[a + (-a) = 0]]></fr:tex>.</html:li>
  <html:li><html:em>Multiplicative inverses</html:em>: for every <fr:tex display="inline"><![CDATA[a \neq  0]]></fr:tex> in <fr:tex display="inline"><![CDATA[F]]></fr:tex>, there exists an element in <fr:tex display="inline"><![CDATA[F]]></fr:tex>, denoted by <fr:tex display="inline"><![CDATA[a^{-1}]]></fr:tex> or <fr:tex display="inline"><![CDATA[1/a]]></fr:tex>, called the multiplicative inverse of <fr:tex display="inline"><![CDATA[a]]></fr:tex>, such that <fr:tex display="inline"><![CDATA[a \cdot  a^{-1} = 1]]></fr:tex>.</html:li>
  <html:li><html:em>Distributivity of multiplication over addition</html:em>: <fr:tex display="inline"><![CDATA[a \cdot  (b + c) = (a \cdot  b) + (a \cdot  c)]]></fr:tex>.</html:li></html:ul></html:p>
          </fr:mainmatter>
        </fr:tree>
      </fr:mainmatter>
    </fr:tree>
    <fr:tree show-metadata="false" hidden-when-empty="true">
      <fr:frontmatter>
        <fr:authors />
        <fr:title text="Contributions">Contributions</fr:title>
      </fr:frontmatter>
      <fr:mainmatter />
    </fr:tree>
  </fr:backmatter>
</fr:tree>
